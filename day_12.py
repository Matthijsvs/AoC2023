inp = """?#.???#???????##?.? 2,1,7,3,1
?.##?###?#?##? 1,6,1,2
??.???.?.?.??.???. 2,2,1,1,2,1
?????#???#??#??..?#? 15,2
#?????????#.?# 1,2,5,1
??..?.???# 1,4
?##???.???? 3,2,2
..??.????????.?? 1,3
.?????????.#?? 1,6,2
?#?#??????##??#..# 1,2,7,1
??.?????###?? 3,4
.???????#.? 4,3,1
??????#.?#???? 2,2,4
???.???#?..?????. 2,1,1,5
???#???#???#?#?????. 2,9,2
????.#.?????#?# 1,6
???????.#?? 1,1,2
#????#??.???. 2,1,1,1
??#?????.???? 2,1,1,1
.#?.?.#????#?.# 1,1,4,1
##?????##??? 3,3,2
??.?????#? 1,1,3
??????.??????##.??#? 2,2,1,6,3
?#???.?#?? 1,1,4
#?#???.???? 4,1,2
.#.?.??#?? 1,1,3
.?#???#??#??#?#?. 1,10
?##...?##???.? 2,5
.#?????????????? 8,1,1
???...???# 1,1,1
??#???.?????????#?? 3,4,4
????.?.???.#.?? 1,1,3,1,1
?#??.?#??? 2,1,3
?????##????#???? 11,1
??????.???? 4,1
?????#?..?#?.?? 2,2,3,1
??????.#..?#????# 2,1,4,1
??.???#..#? 1,2,2
#?#??.#????#? 1,1,1,2
?.#?..?#?? 2,4
?.?????##??.#?????## 8,8
???.???.??. 1,2
??#??????# 7,1
????#?####?#?# 9,1,1
???#??#.????. 1,4,2
??#?#?????.##??.?.?? 5,1,1,4,1,1
.#??.??????#?????#? 1,1,5,3
???#???.????#???. 4,1,4
.?.??#??????#??. 3,5
???????..?? 1,2,2
????#.???????? 2,2
?.????????##?? 3,2
?.?.????????#??????# 1,2,4,4,1
???#??.????.???#??? 4,1,1,3
????????????.. 5,1
??.#??????## 1,1,1,2
..?.?#?????.?.. 3,1
??#??.?#??.??#????? 4,3,3,2
???#?#???##????##?? 5,7,2,1
.????#?????#.. 5,2
..?#..##???.? 2,3
???????.?.? 4,1
#????????#?????. 1,3,1,6
?#?#??.??.?#????. 1,3,1,6
?#???.??#??. 4,3
?#.#.????#?#?????#? 2,1,8,4
??.#???????.? 2,2,1
..???????.? 2,3
?#.?????????? 1,7
?.??#??#???????????? 1,7,3,1,1
???????.#????? 3,3,5
?..????.???#. 1,1,2,1
?.?????.?#.??..? 3,1
.#?..?##???? 1,4
?????...??????? 3,2
???.?.?????? 2,1,1,3
#???#.#?#??? 5,5
????#???.??? 5,1,2
????#????#?.??##?#? 1,4,2,4,2
??#???????????. 2,1,1,1
#?.##??###????.????? 1,7,2,1,1,1
?#??##??.?#?#?##?? 5,7
?#???.?#?? 4,1
..??.??#???. 1,4,1
??.????.?? 1,2,2
???.??.??#???? 1,1,5
?..??#?##???#???# 1,6,5
???#?????????#?? 4,1,5
?#???#?#??.? 1,1,1,1
???.???.#?.???. 1,3,2,2
????###?..??.?#???. 7,1,4
.??#?.????? 4,1,3
.#.??????? 1,3
#????##???.? 1,5
??.???#?????#???? 2,3,5
??#?##?????# 7,2
???#????#.. 4,2
.????.????#?#???? 3,1,3,5
??.????.???.??#??#?? 2,1,2,6
?????#??#?#????? 1,5,3,1
??????.#?? 3,2
??#????.?#?. 4,3
???#???????????#?#. 2,1,3,1,1,3
???#.?###???##??# 1,1,12
?#????#?##.???.?.?#? 1,6,2,2
.?#??.?#???#???????. 4,7,1
?###???#????##??.? 5,2,2,1
??#?#????#?#?..?? 1,1,4,4,1
???.#?.?????? 2,2
??#???#??????? 7,1,3
?.?##????#?. 3,4
??.??#???????. 1,1,4
?.?#???????...????? 7,2
????.???#??.?. 1,4
.#?.?#?#??????? 1,6
.?????###??????????. 8,3
#?.#?#??#?????? 2,3,2,4
#?#?#????.??????? 6,7
??.?#??.#?#? 1,2,1,4
??.?#???##?###?# 1,2,6,1
?.??...??? 2,2
#??##?#??.?#??? 1,3,1,1,2
????##?????.??.?.. 4,1
.?###????..?.?# 8,2
.????#??.#.#?? 5,1,3
??#??.????##..? 4,6
?#?..???#?????????.? 2,1,4,5
..??..??#.?? 1,2
?.#?.?.???#?##?????? 1,2,1,1,5,1
??.?##.?..???? 1,2,1,2
??.??????#?.??? 1,1,4,2
???#...??#?#.# 1,5,1
????.???##?#?.# 1,8,1
.???#?????.? 3,1
.##???#.?#??#??. 3,1,2,3
??#??????#???.? 2,1,1,3,1
???#?.???#???#??? 2,3,2,2
???????#???????????? 2,2,10,1
.???#??.?#??#?#. 1,1,1,6
????##??#?.. 6,2
????###?##?#?? 4,4,1
???#????#???? 3,7
?.?###?.#???#??? 3,1,3,1
.#?.??#?.??#??? 1,1,2,2,2
????#??##?. 1,5
???????#?##.?.#.? 2,6,1,1
?#?..???.?#?..??? 2,1,1,3,1
??#???#.??.#?#???# 1,1,2,2,4,1
.#.?#.?#???#?. 1,1,1,3
??.##??.??#.?.? 1,4,3,1
.?#??.????# 4,1
???##?#????##? 2,10
??#???????#? 3,1,2
##.??#?#??##? 2,9
?#?#?#?????.???.?.? 10,1
?..#????#????#?. 1,1,1,6
...?????#???????# 9,1,2
.???.???.?? 3,1,1
??#.?.????#?#??#??? 1,1,1,10
??.??.#??#?#?.??#??. 2,7,2
??##?#?..??.??? 7,1,1,1
?#????.#.???#.?#.# 5,1,4,2,1
.?####??#.???? 8,1,1
????..#??????? 1,1,1,4
?.#???#..????? 3,1,1,1
???##?#??.#? 1,2,3,1
?????.#???#?.???. 1,6,3
.?.???????. 1,2
#?.?????##? 2,6
?##???????? 2,2,1
?#.##??##?# 2,2,4
??#?.#?.#?.?#??#.?# 1,1,1,1,5,2
????#???????#?.?#.. 9,2,1
?????#.??####? 1,2,7
#???#?????? 6,1
???#?.????# 2,2,1
.#.#.#??#?? 1,1,6
?#??##?#????.?..???? 8,1,2,1
?##???????????? 4,5
??#??.#?????##. 3,1,3
???.?#?????????#??.. 1,1,12
??????#?????.?# 1,7,1,1
??.#???????? 3,1
??.?#?#?.???#??? 1,3,6
?#??#???.??.??# 1,1,1,1,1
#???#????????.???. 1,1,3,5,1,1
#??..?.#????#? 1,1,1,4
?????.???? 3,1
??????###?.? 1,7,1
.#..?##??#??.???? 1,6,2
?##???#?.## 6,2
?##.??.??#?.???#??? 3,2,1,1,1,1
???##.?#????#??? 5,1,1,3
#.??#??.?#????.???#? 1,3,1,6,1,1
??#???#.??#.#??? 7,1,1,1,1
#??#?????.?.? 7,1,1
.?????.?#????..#?#? 4,5,3
?.?.#??#??.????? 4,1
#.??#?##?...#. 1,5,1
.??..?.##??? 1,1,4
???#????????#??.? 3,8
???????##?????? 2,1,4,1
???????.??. 2,2,1
?#.#??##???.???? 1,1,3,1,1
?.?????????. 1,1,3
.???#??#??.#?####?# 6,8
?.?#??#??.?? 1,1,2,1
.??.???#??????? 1,6,1
??#..#???.?? 1,1,1,1
?...#????.#? 1,1
??.??.???. 1,1,1
??#?##????.#?.?? 10,2,1
????????.?#????#???? 2,3,4,2,2
???????#?#????.##.? 2,8,2
??#?????.?. 4,1
??#???.?.??#?????? 1,1,2,1,5,2
.??.????#?#?#?? 1,1,3,2
#???.??.#??##?????.? 1,1,1,1,5,1
##??#?????#??????#?? 5,12
.?#????..??#?#????. 5,7
????#.?????.?.?#? 4,1,3
.#..?#?????.?# 1,5,2
??????.?????# 3,1,1
?#?????.??? 1,3,1
#.??##???##?.???##? 1,10,2,2
??#???..#?#? 4,1,1,2
.?.#?.?.???. 1,1,1,1
.#?.#.#??.?????? 1,1,2,1,2
?#??.?#????#. 2,6
??????##??. 1,2,1
???????.??.????.?? 1,1,1,2,4,1
?#??????#??###.#.?? 3,10,1,1
..???#?????#?#?#? 3,7
?..#????????. 1,1,4
?#??#?#.?? 1,4,1
???##??##?.? 2,2,3,1
#??#####???#.??? 8,2,1
??#?.????.? 3,1
...????#?? 1,4
.?#?????###?##.? 3,4,2
????#.????##??? 1,4
?##??????.## 2,1,2
.?..?#.????#????? 1,1,8
.#?#?.?.???..? 4,3
??#??????#?#. 1,1,5
#?????#?###????#??? 1,9,1,2,1
???????###??.??.? 1,1,8,1,1
.??.???#?#.#??.?#.# 1,6,1,1,1,1
???#????????. 5,4
.?##?????????? 7,4
?????.??.?#?? 5,1,2,1
#.????????## 1,1,3,3
???#????.????##.?? 7,5
.#?.??#??##??? 2,7
#?..??#?#..???# 2,4,1,1
??#..??#??#????#???? 1,1,1,4,4
??????????????. 2,1,1,4,1
#??#???.?#. 4,2,2
#.??#???#??.?#??.?? 1,8,1,1
??.???#?????#?????? 1,2,3,3,5
????.#..???#??#?#? 1,1,1,7
.#?????.???????.# 3,1,2,2,1
???##??.?#??.?? 5,2,1,1
????.?##????# 2,2,3
??????#.?#?? 1,2,2,1
##?.#.#??????#?? 3,1,1,7
?????.?????#???????? 6,1
.?.???##????. 4,2
????#????#?????? 1,6,1,2
??#?##??????##?#??? 1,7,7
?..???#.??.? 2,1,1
#?????#.??.?#.???? 1,5,1,2,1
???##?#??..??.?#?? 3,3,2,2
?#??.??#?.? 2,4
?????????#??#?????? 1,1,7,2
???#????#???#?#?. 1,7,6
?????#?..??#????#??? 4,4,5
#?#???????????? 3,4,1,1,1
???#????#.#.???? 1,3,1,1,2
??.??#???#.?? 2,3,1,1
?????.??##???.??.?? 1,7,2
.??#???????##??? 1,10
?###????#????#??# 4,1,3,4
.?????.?.??. 3,2
?.?.?#??.?? 1,2
#?????#???#? 7,2
??#??????.?#???#?#?? 5,8
????#??.????#.???#? 1,4,3,1,1,2
???#??.???? 4,1
?#?????#?#. 3,3
#.?????#?.????#?# 1,6,4,1
??#??..#????. 2,1,2,2
#?????#??#.??????? 2,3,1,3,1
?????###?#?.??#?? 7,1
###???????.?? 4,2,2
??#..??### 3,5
?.##.#?????? 1,2,1,3
??#?#?.#?.#???? 1,4,1,3,1
.?????????? 1,2
.????.#??#???##?# 1,1,1,2,5
?????##?????????. 4,5
???..???#?.#.?#?#?? 5,1,5
???.???????##???.?? 1,1,2,1,5,2
??.????#??##?????? 1,9,2,1
#?#???#?###???#??##. 1,10,5
????##????##?..?# 2,4,2,1
##??..?#???????.? 3,5,1,1
??##.?#????#??#.?# 4,10,1
????????????? 1,1,1,1
?.????#.?.#?.? 1,5,2
.?.#??.#...##???.?? 1,3,1,2,2,1
??##.??..?#?# 2,2,3
.?.#????#??#? 2,6
.???????#??#.???.? 1,7,1,1
??.???????? 1,3
??.??#?.?????##??.?? 1,3,6
????.?????#?##??.? 3,11,1
???..????#.##? 1,2,1,3
.??#???.???. 3,1,1
??.???..?##???.. 2,2,4
???.#??##???????? 1,1,4,1,1
.?..?????? 1,1,3
??#???..???? 5,2,1
?????##??#??????#? 1,9,1,1
??.?????.??????# 1,5,1,1,1
??????#???. 1,1,5
.?????###..?.#?. 1,1,4,1,1
????#?#.???##? 1,3,1,5
?.?..????###??.. 1,5
???.#????. 3,1
.#?#?.#?#?.???# 1,2,3,4
????#??#??#?#???? 2,7,2
.?.???#?#??##???# 1,13
#??#???#..?#??#????? 1,6,5,4
#???????#?? 4,5
.??#??????.??# 2,1,1,3
??#????.?.# 2,1,1
.#??##?#.#?..???# 7,1,3
..?#??????##??.? 3,1,4
#??#??#??.?#. 1,5,1,1
.???#????.#?#? 6,4
.??#???#?.??????? 3,1,2,3
????????.#?#.# 1,3,3,1
??.?#????#?????????? 1,11,1,1
..??#?.???#?.?.?. 3,1,1,1
?#?????##??##.# 2,8,1
????#???#??????? 2,1,6,1
#???.?##???#?## 1,1,4,2,2
?????#??##?#??# 11,1
?.?#.#????#?#?#?#? 1,1,3,2,5
##???.????.???? 3,1,1,2
???..##?.??..#? 2,3,1
???#??#?.??.????? 6,1
?.?#??.????#??#?#?? 2,7
.?#????.??#??#???#? 6,2,2,1
???.?#???.? 1,4,1
?##.????####? 2,6
###??????#?#? 5,3
?.#??#.?..##?????? 4,6,1
?.#.#.???#?##??????? 1,1,1,10,1
??.?#?????# 3,2,1
??#????#?#?? 2,3,1,1
?#?.??#.??? 1,3,1
????.?#???#?#????? 2,1,2,3,1,3
????#?.??#????.#? 1,1,5,1
????????#??#??#?#? 1,1,1,1,5,2
???.??????#? 1,2,4
????.??#???# 1,5
?????????#?????????? 2,10,2,1
??????#??.. 2,3
?????#.?#??#?? 3,1,5,1
?????#??#?..?? 3,4,1
??#???#???#???.?.?#? 3,10,1,1
#?##??????#???????. 7,1,3
??#??????.?##??##??? 7,7
??????##?#?????? 1,8,1
.????#??#???????. 7,3
?#?###???... 5,1
.?#??????.????? 1,2
?.?#?????#.???#?? 1,5,1,3,1
????#?????#??#??. 5,2,2,1,1
.?.?#?#???#??. 1,5,1
???.????#??##?? 1,8
#???.????#???????? 2,8
??.##?#?#?? 1,6,1
?????????#..?#?#?..# 9,4,1
??????..?.???#.#?? 2,4,1
?.#.?#????. 1,1,2
?##???#?????##?.???# 3,5,4,1,1
#??#?#.?????#??#?##? 1,1,1,1,7
.?.????#???#??????? 1,1,1,2,6,1
??????????###?? 2,7
#??????#?###?????? 1,10,2,1
#??.?.??#?#? 2,1,5
.#..?????#?.?? 1,1,4,2
#?...#?.#???#? 2,1,1,3
###?#??##???????#?? 14,1
??#?.?#????#??#????? 2,11,1
???...??.#?#?. 2,1,4
#??.#??#????#?? 1,4,6
???.#.??#?#???.?##. 1,1,1,6,3
???????..?????#??? 1,1,1,1,6,2
???##????.????#..?. 5,2
.???#?.?????#. 4,2,1
.??????????#.#? 1,1,5,1
????.?.??#?##???? 2,6
#?.?#?.????#.?????# 1,2,1,1,1,4
?#.?#??????#? 1,9
??#?#???#?#?????.?#? 7,1,1,1,1
...?##?#.????. 4,1
?????????.#? 3,2
?.#?#?????#?? 5,1,1
?###.???#?. 3,2
?.???#.????#?? 2,6
???.??..???#??. 1,2,5
?#..?#?????##???. 2,9,1
#?.??###?#?#??.????. 2,8,1,2
???#?.????.??????? 4,4,6
???#?????#?#?.# 2,1,5,1
.?????#???#??? 1,2,4
???##??????? 6,2
???????#.????#??? 6,1,2
????????#???.?#??## 1,1,1,1,1,6
?#?.?#??#? 2,2,2
#..?.?#.???????#???? 1,1,1,1,1,5
???.?.???? 2,1
#???..???#??.??#.?? 1,1,2,3,1,1
???#..##?#???#? 3,4,1
??.#????????????? 7,3,1
?..?.?????? 1,1
?#????..#.#????? 2,1,1,1,2
.?.???????????? 1,1,1,4,1
?.????????#? 2,3
#?????#..???#? 1,3,1,1
???.?????##. 3,2
?.??????#??.???#??? 4,1
.?????#??#???#?#?. 8,4
???..?##??.# 1,1,3,1
???.??#??#?## 1,7
????.#??#????. 1,5
#?..????.#??.?? 2,3,3
???????##?????????# 3,1,9,2
#??##?#??#.?#? 2,2,4,2
?.?#?#?????. 1,1,3,1
?#???#??????? 6,2,1
?????..?.#?. 1,1,1,2
?????.?#??#??. 1,5
??#??#.#?? 2,1,1
..?..#.#??##?#..#? 1,1,7,2
??????##?#?.??#??? 1,1,2,1,5
?#??#?#??.??.??? 2,2,2,1,1
??...??#?#?#????. 1,8
???#???#?# 1,2,4
?#??..??.?#.? 2,2
#??#??#??? 1,6
?????...???##?????? 1,2,5,2
?#..#?????#???#..? 1,11
??????.????.## 2,1,2,2
??#????#??##??????. 1,9,1,2
#??###???..???? 6,1,2
????????????#??.???? 9,2,1,1
??#???????? 4,1,1
?#????#.??#????? 4,1,1,1,2
?#..?#?????????#?? 2,3,1,1,1,2
.???????#??.? 2,6,1
???#?????#?????#??#? 1,8,1,4
?#?.???.??? 1,3,1
.??????...??.??#?.?? 5,1
??.?#????#???##???.? 2,1,11
???#?.???#.#.? 4,4,1
#?###?????#.???? 1,4,1,1,1
.???.?????.???? 1,1,2,1,1
???#??#????.??? 4,3,1
????.?????#?? 1,1,5
??##??.?..?????? 1,3,1,1,1
????????..#?. 7,2
.????##??..? 1,3,1,1
.##?#??.#?#?#??? 5,1,1,2,1
.????##?.??????? 2,3
?#?#??.?.. 4,1
?????????#?.??? 1,6,1,1
????#?#.???. 7,3
?????#??#?##?????.#? 12,2,1
???#??#?.?#????#?? 7,7
.#.?.????????#. 1,2,1,1,1
.??.????## 1,5
????#??.?#????.. 2,1,4,1
.???#??????#???????? 1,1,11
.?.???.???#?#. 1,1,2,1
??#????#??#????.. 6,5
#?##?.?#???#? 4,6
????#???????????? 1,2,1,1,4
??????#??.???????? 1,1,3,3,1
?????.###??#?? 1,1,8
??##?.?????.? 4,2
?#.??.???? 2,1,2
??#????.??#????. 4,1,3,1
.?????#?##??. 1,7
?###.??#?????. 3,4
??#????##?##???.?? 4,6
????#?#????#???#??? 5,7
?#??#????? 2,1,4
#?#??.??#???.? 5,2,1
?#?#?????? 3,1,1
?#?#??.????#? 5,6
????.???#.???# 1,1,1,4
?#????.????.??? 4,3,2
.???.?.????#??##?.? 1,9,1
???.???#???.????#?? 1,1,7,2,1,1
?#??????.?#? 2,1,1,1
.???#.???#?? 3,4
???#??#??? 2,1
???#?#?#?. 3,1,1
##???????? 4,1
?.?#???.##? 1,3,2
.???.?.?#????? 1,1,1,3
??#?..??????? 2,1,1,1
.#.??#?..? 1,3
?.???#????. 1,3
????????#?#??? 5,1,1,1
??#??????.?#???..? 4,1,1,1,1,1
??????.???##? 1,2,1,4
???????#???????? 1,12
..??..?#????###?.? 1,10
?????#?#??#?.??#?#? 1,1,7,1,1,1
.?#????.??#?? 6,1
?#???..??????#?. 1,2,1,6
??.?#??#?##????#?#. 1,2,11
??#??.???#?#??#?#. 4,1,5,1,1
.#.?????#????? 1,1,7
????#.????#?#?#?# 1,1,9
#?.???#???.?#.?#? 2,4,1,2,1
.???...???. 3,1,1
..?.???##?..??#???. 2,3
##?#?????????.??# 5,1,4,1,1
?#????.?.??#### 2,1,1,1,5
?#????#?#. 1,2,1
?##?#??????#???????# 8,1,1,1,1
?.??????#####?? 2,7
#????#?????#????.??# 10,5,2
???#?....#? 3,1
.?#???.???###????? 2,7,3
.??????????????## 8,2,4
?????????.#?#??. 4,4
?????????.?###??? 1,2,3,5,1
??#??##.?????. 6,2
..?.?##.??? 1,2,1
?.?.????.#? 1,3,2
?#????????????.??? 2,4,3,2
.??..??.?.?#??????? 2,1,8
#????.?.#?????# 5,1,4
?#????.?#??#.?.? 2,5,1
??##???#???.??#.? 1,6,1,1,1
.???????##???#?.. 1,10
?????.?..???..? 3,1,1,1,1
??.????.???.?#. 1,3,3,2
???????.#? 1,1,1
?.??#??????#??? 5,4,2
.???#?????#.? 1,3,1,2
?#??#??.?????#?#??#? 5,1,1,1,1,3
#.?#?????#??#??? 1,9,1,1
???..????#?#???#. 1,1,2,7
.??#?#?#??#?.?###?? 2,3,3,3
??????#?.????# 3,2,2
#?##?#??#?##? 1,10
?#??#.????#?##? 4,7
??????#???#?..?# 7,1,1
?????.?.?#?? 1,1,1,1
.???#?????#.?#?#?.? 5,2,1,1
??.?#.????#? 1,2,1,1
????#?#??????? 2,6,1,1
?.????????#? 1,3,1,2
????????.#?#?? 5,3
??????#??.? 3,1
...?#?????#??.?# 3,5,2
?##?#????.??##?.? 6,1,4
#?.?.??##?#? 1,1,5
????#?#???#?????#. 1,5,1,2,1
##?#?#??.??.????? 8,1,1,1,1
??#?#?????????#???? 11,1,1
??#.#???#???#????? 2,3,1,3,2
?.??#?.??.???. 1,3,1,1
?#????#?????? 1,5,3
?#.?.??#?.?#???# 1,1,6
.??????.?#???????? 1,1,2,1,4
?#??.??.??.? 1,1,1,1
?#?##?#?????##?..## 9,1,3,2
????.?#.???????.# 1,2,1,4,1
.????.???#?##? 1,1,4
?#?.?????#?..##? 1,2,2,3
?#?#?.?#????#. 3,2,2,1
#.??#?#???? 1,3,1
???..##??.? 1,2,1
???##????.?????????# 9,1,3,2
####???.???#???#? 6,1,4,1
.?#???????#. 2,1,1,1
.??????????? 1,1,2,1
#?##?#??##?? 6,3
..?.???.?. 1,3,1
?..?.?#??????.???.? 1,1,3,1,3,1
.???.#???#??.? 1,7,1
?##?.??##?.????? 4,4,2
?.#####???#????? 7,4
????#??.?##?? 3,2,1
??#.????.?#???##?#? 1,1,1,3,3,1
.????..??#?#?##?#??? 1,13
?.???.????#?????? 1,1,6,2
..??.?????????????.. 1,2
?.????#.?#?? 2,1,1,1
???..#??#?.? 1,1,2,1
??????.??#. 1,3,2
??#??#..#?. 3,1,1
.?..???#??#. 1,4,2
?.#.????.? 1,1,1
?#?????.?.??.???#??? 4,1,4
?????#?#.??.? 4,3,1
#?#??????##??#?#???. 4,2,5,1,1
????#?????#??## 2,3,3,2
?.???????.????? 1,2,1,1,4
.???.?.??#.#?? 1,1,2,2
?###?##?#?????..?? 10,1
???????#?????.#.??.# 6,1,1,1,1,1
??.????#??????. 4,1
?#???#.??#?. 3,1,2
?##?#..?#?..??.. 5,3,1
.####?#???.?.?#?... 8,3
????#?#????#??#????? 1,11,1,1,1
????.??????#???? 2,2,2,4
?.#???#?#??. 1,4
??#???????#??...??? 4,1,3,1,2
??.???#???#???#??.? 1,3,5
????#?..?? 3,1
.????#??.?.?? 3,1,1
??#?##????. 1,4
?#?..?????????#?. 1,10
#??##??..#.#? 7,1,2
???###?????.???## 1,8,1,2
#??#??.?????????..? 1,1,9,1
????#?????#???.?? 12,2
?.????.?##????.?? 1,3,3,1,1
???##..????.? 1,2,4,1
#?#??.???.??#?#?? 1,3,1,5
??#?#??????????? 1,8,1,2
#?????#??. 3,3
.????##??.????? 1,4,1,2
????#??????..??.# 9,1,1,1
.??????.#.#? 1,1,1,1
?.??.#??.??.??#.?.? 2,3,1,3,1,1
????##???##???#?#? 1,9,3
.???.??.?# 1,1,1
???#?????#??. 3,1,2
??????#.??????###.? 6,4,3
?#?.???#???.?#..?? 1,1,4,2,2
??.?????.???###.??? 2,2,1,5,2
?###????#?? 3,3
?????##?.?#?##???. 7,6
???#???##????? 3,4,1
..?????.?##????.??.. 4,7
.?...???#? 1,3
??##??#????.#??????? 3,1,1,6
?..?.#?????#? 1,1,2,1
???.??#???? 1,5
.?#??#??????????? 1,3,1,1,1
????#?#?.?#? 7,1
?.???#??????.. 5,1
?#???.????.?#??? 1,1,1,1,5
?##????.?. 2,1,1
?#.?.##??? 1,3
?#??????.?..?.???. 1,2
#?????????#??#???? 5,1,8
???#.????.??? 1,1,2,1
????#??.##? 1,1,2
???????#??#? 1,8
?????.?????. 2,1,1,1
????.?#?###?.?#???. 2,7,2,1
???.##????????????. 2,3,7
#???#????? 3,1,1
???##???##???# 1,3,3,1
#???????#.?.?.?? 9,1,2
?#?????##??????? 3,10
???...?????###?? 1,7
???.??#?##?#? 1,1,2,1
#.?#???#?????#. 1,7,1,1
#??????????? 3,3,1
.???.?.#?????# 1,7
?###???#??#?.?#????? 12,1,1,1
.??????#????.??? 6,1
?#?.##?##??.? 2,7
???..??...??. 1,1,2
??#??#?#???#???????. 7,4,3
??.??#????. 2,7
.?#?.????#??#.?? 2,7,1
?.#.??#??#???.?? 1,1,8,1
????#??#?#.??.?.#### 10,1,1,4
.?#??????.?.???? 8,2
??#?.??.?? 2,2
??????.??????##?? 4,4,5
?#??#?.?#? 3,1,3
???###????..????..? 7,4
??.???????#?.? 2,5,1,1
?#.?#?????? 1,3,1
?#??.??..##?.???#.? 4,1,2,1,1,1
??????#????#?#??.??. 1,3,8,2
??????#?#???? 6,3
?????##????#?##? 2,3,1,5
??#??#??####??.??##? 12,4
..???##??#?#??.?. 10,1
?.?????##???? 7,1
.????#??#?##????.#? 2,11,2
?????...?.##?##? 3,1,6
?????#????.? 1,7,1
?#???#?#?? 3,1,2
??#????????.?#?? 1,4,2,1
?????#?#??? 1,6
?...?#??..???????.? 1,4
??.???##?#??##?.??? 1,1,10,1,1
???#?.?.??#?#?# 1,1,1,7
?#?..???##?? 3,1,4
??.??.?#????##?.??#. 1,1,9,2
??????????? 2,1,2
..???????#? 1,2,1
##??##?.?. 2,2
??###??.????#? 3,1,1,3
?..???#?.? 1,5,1
.#??????.#?. 1,1,2,1
.????#??????????.? 1,5,1,1,2
????#????...??????#? 3,1,3,3,3
.??????.??. 3,1,1
????#?#????#??#??? 1,1,1,2,2,1
???..#????.? 1,1,1,1
?##??##?#.?#?.??. 4,4,2,2
..??????##???? 3,4
????.?.??#??? 3,1,2,1
???????.?. 1,1,1
..#?.?##?#????##?? 2,11,1
??????????#???. 3,6
.?????.??.?#??# 1,1,1,2,4
?.???????. 1,1,1
???#??????#?## 4,1,1,2
.?...?????.???? 1,4,2
?##??#?????..?.? 9,1
??.??#????#?.#??#?? 2,6,1,2
.?..#??#??#.?#?##?.# 1,1,4,4,1
??.?#??.#? 1,2,2
.#??..???#. 1,3
???##.#?.?? 4,2,1
?.#??????.?## 2,1,3
##????.?##?#?????? 2,1,1,6,1,1
#..???#???#??#???#?. 1,6,1,1,1,1
?.??.?#?#?.# 1,2,1,1
..##?????.## 5,2
??##..???#?##????? 1,2,8,3
.??#?##?#?#?#??. 10,1
#??##?#??.??.#? 8,2,1
????...??#?#?#??.??? 2,8,3
??..#.??#???.?#??? 1,1,4,1,1,1
???.?????.???.?# 3,1,1,1,1
.??###.?#????. 3,3
##?#??.??..?##?. 4,1,1,4
##????.??#??????.??? 6,3,1,2,1
?#?#?#?#?????? 1,1,1,5
.????##????. 2,6
#???##???????.?????? 10,1,1,1
?#??.##?#?? 3,2,2
?#?????.#??## 1,2,2,2
.?????????#??#?.?? 1,1,9,1
???????##?#? 1,1,4,2
??#?.??????.??#??#? 4,1,1,1,1,5
?#????.???? 3,1,1
??.?#??##? 1,2,3
.????????.? 1,1
???.???#?##?#?#??## 1,2,9,2
?????#?##.?## 3,4,3
#????????? 1,2,2
?#..?#?.?#..??##???? 2,1,2,1,3,1
..??????????#?#????? 2,4,5,1,2
??#?#?...???????? 3,2
??#.##??##?????? 1,1,2,2,4
?#?.??.???#?# 2,1,1,1
.##.???#???#.?.? 2,1,2,1,1
#???#???#????#??#. 1,1,1,4,5
?#?.????.? 1,1,1
#?????..?. 1,1,1
??.?#???.??#? 2,1,2,3
..??.?#???##?#??#?#? 1,14
?.?#??#????##????##? 6,3,5
????..?.?.???###??. 1,1,1,1,5,1
?.??#?.??.?##?##### 1,8
?.?#?????.??? 5,1
???.##?????????? 2,2,2,1,2
?.##????##???????#.. 2,11
#???????#??#???? 1,1,1,6,1
#????#??????# 1,1,5
??.#??#???..##??#?#? 1,6,7
#??##?????????###?.. 6,7
.???????..#?.#??.? 2,2,1,2,3
????????#?#???#??? 11,1,1
??..??.????? 2,1,1,3
?.??#??#??? 1,1,2
??.??##?#.?#??#?.??? 1,6,5,1,1
.#?#?#??#?#?????? 10,1,1
????????????#. 6,1,2
??.??##???.??? 5,1
.??????#???###?.? 1,1,1,4,1
#.??#???#????????. 1,4,5,1
##?##?????#???#??#?? 15,1,1
.????#?#?#??? 2,1,5
??###??.?? 4,1
??#?#??.?? 4,1
??.????.#.??#??? 2,1,4
?????..???#?.?? 1,1,1,3,1
?.#???????????#???# 5,1,3,3
.???????????.?? 2,6
??#?????#.?#????? 8,4
??#...#???? 1,3
?.??.#??.####? 2,3,4
#?????#?????#??#?. 1,1,1,1,3,1
????#????### 2,8
?????..??. 2,2
?.??#..???#?##?? 3,7
?##????##??#. 2,1,4,1
.#?????????##?.?#..# 1,3,1,4,1,1
?#?#??#????.#.#??. 1,1,3,1,1,1
??#???.??????#?.. 2,1,3,3
#?##???#????#. 1,11
??..?..????#???# 1,1,1,3,2
??#?.?#?#? 3,4
??#???#??#?# 3,3,1,1
#.?..?##?#????#??##? 1,1,3,4,1,2
???????#?.?????#?? 6,7
?#??#??.?????#. 5,6
?.??..???#?..??.??? 3,1
?#??#???#? 1,1,2
?.??##??????????? 10,3
##?..#???#?.?? 3,3,2,1
??#???..?#???? 5,6
?#?.??#???.??#?? 3,3,1,1
.#???????.#????##?. 3,3,7
?.??##??..?? 3,2
?#??.???.???.?#? 4,1,1,2
?##?.#??#?? 2,1,2
.???#?.???????##.?? 2,3
?#??#??.?.????..?? 1,4,1,1,1,1
?.????????. 1,6,1
?????##?#????.#. 8,1,1
?..????????????????? 1,11,1,1
..?#?????#...? 1,3
?.?#???#.?? 2,2,1
##??.???.?? 3,1,1
???##??.?.#? 5,1
??.?..#??.?.? 1,3
.???.?##????????? 3,11
#..?#???#??.???? 1,8,2
.??????.?.?.????#?#? 5,1,2,5
.?????#???#???..??? 5,3,1,2
?????#????.? 8,1
.??#.??????##?.. 1,9
#???#?#..??#?#???# 1,1,1,1,7,1
#.?#??##???#. 1,1,2,1
.??????.?#???? 4,5
???##?.??????.#.??.? 3,6,1,1
????.#??????? 1,4,1
??##?.???? 3,1
.??##?????#?#???#? 1,4,6,1
??#?####?##?.??#?#? 12,3
#.?.??##?#.????? 1,1,4,1,1
???????..# 1,1
?????#??????#. 2,5,4
??#???#???.??#? 7,1,1,1
??????.?###. 2,4
?#.??#??#????. 1,8
???#???##??#?? 1,9,1
??###?????????? 11,2
??...??.#?#??#??. 2,1,1,1,3
???.????#??.?. 3,1,2,1
??###??#????. 1,3,2,2
??#???????##?? 4,1,5
?#????????#.??? 1,7,1,1
???#???#?????# 1,1,7
?????.??.?????? 2,1,2,1
??????#?#??#?.?? 1,1,3,1,1
?##?#??#?.#? 2,1,1,1
?.???.??.??????? 1,1,2,2
????????..???#? 1,1,1,1,2
??????.##?.?###????? 5,3,3,2
#???????## 1,1,5
???.??#??#??#.# 2,1,1,5,1
???#????.#?#? 4,2,3
??.#??##????? 2,7,1
???#?.?.?????? 5,1,2,1
???.????.? 1,1,1
???????##???????. 1,8,1
??.?#???.#??#?? 1,1,2,2,1
?.???????.??#??#?.?? 7,6
?????..?#???. 2,3
???##??#??.?? 9,1
??#?##??#??.???#?? 11,5
????????#??#??# 4,9
.??.?.???? 1,1,1
??????##.???? 3,3,2,1
????????#???#??#???? 1,11
#.????#?????#?#???? 1,1,1,4,5,1
??..????????.??.???? 2,1
#.?#?#?..?.###?#?? 1,2,2,1,5,1
?????.#.??# 4,1,1
?.?.?????????????#? 1,9,1
???..###?.? 2,3
???#???#.####???? 3,1,6
?#???#??????##?..? 1,7,3
????#.????#??.??.?? 4,1,3,1,1
???#??????? 2,2
#.??.???#??#???#? 1,1,4,2,3
#???#.???????##??? 1,1,2,1,5
.????#?????#????? 1,4,5
??#..#??#? 1,1,1
..?#?????. 3,1
??.???##?? 1,2,3
????.????? 1,1,1
?##???.#?#???.#.#? 2,1,1,3,1,1
??.#?????##?#..??.?? 1,2,1,5,2,1
.??????#??#????#.? 1,4,1,4
??#?#?#?##????.?? 1,10,1,1
.????????# 2,1,1
??#???.????.##?? 3,1,2,4
???.##?.???.???#?.?? 2,2,2,1,2,2
?##?????#?????#?? 2,4,1,4
??.?#??#???????.?? 2,2,1
#??#??????.????#? 1,7,3
?.#???#.#? 1,5,1
.?#?????#??.? 4,3,1
.##??.?????.?? 4,1,2,1
???#??#?.?? 1,3,2
?##???#????. 2,1,1,2
????.###?? 2,3
#.??#?????????????? 1,5,6,1,1
????#????#?.# 2,7,1
????.??#.? 3,1
??????..?##.?????? 2,1,3,1,1,1
?#??.?##?#??? 1,1,7
#?.??.#..??? 2,1,1,1
??????#??.??#??# 1,2,3,1
??##??##??#?.. 1,2,3,3
??????????? 1,6,1
??????.##???#??? 2,8
#????????#?? 1,1,1,2
???????.??? 2,2,1
?.????..??.?.?? 1,3,2,1
#??.#?#???? 1,3,1
???###.?..#???.#??. 6,1,1,1,3
.#??????#?#????? 2,2,3,4
?????..#.#? 3,1,1
.?????#.???#?? 6,3
.#??##.???#?#?#???? 1,2,1,6,1
.??#????#?#.?????.? 9,1,1,1
?????????#??. 3,3
?#..?#???#? 2,1,3
.#.??#?###.??? 1,6,2
?.??.?#?.? 1,2,3
??#.????????.???#? 1,1,1,2,4
???????#??#?#??.? 2,1,4,1,1
?????#???..#?? 1,2,1,2
.???#?#???????? 3,1,2,4
???##??.??#?. 5,3
?#.??#??.? 2,3,1
.#.?#?#????.??????? 1,6,1,3,1,1
?????#???????##??# 1,3,7,1
.???????#??.? 1,2,2,1
?#??####??? 8,1
??????.??##???##?#?? 2,1,5,4
?.???????..??.?##??? 1,4,1,1,6
??#?#???????????..#? 3,5,1,1,2,1
??#???#.???.?? 2,1,1,2
?##?##.?????##??# 2,2,7,1
????.???#?#?.?#? 1,2,2,4,2
?#.?#?.?#? 2,1,3
???????#?#??? 1,8,1
??????#??#??. 4,3,1,1
???#??##?#??.?.???#? 2,5,2,1,1,1
.??#??.??###??.?? 3,6
?????#.?#??? 3,1,3
???.??.??#???? 1,1,3,1
.?.?.###???#?????# 1,1,7,1,2
.?##?.??.#??###.?. 4,2,6,1
##.??#???#####?#??? 2,3,10
??????????? 1,1,3
?.???##???..?. 1,5,1,1
??#?#?#?#?#???# 10,2
???#?#??#?##??#???? 16,1
.?..?.??.?#??.# 1,1,2,4,1
?#.?#????#.??#? 1,1,2,1,3
?.#???#???#?#??? 6,4
?..???.#?#??.??.?.? 1,2,5,1,1
?#.????##??###???? 2,5,7
.##????###??#..#???? 10,1,3
?#??.???.?# 4,2,1
????##?????.??#?.?.? 1,7,3,1
?##??.???#????????#? 2,1,3,8
????#??..???.?????. 2,3,1,3
?#.#???#???.??.???? 2,2,1,1,2,1
...?????.?? 1,2,1"""
sample = """???.### 1,1,3
.??..??...?##. 1,1,3
?#?#?#?#?#?#?#? 1,3,1,6
????.#...#... 4,1,1
????.######..#####. 1,6,5
?###???????? 3,2,1"""


def compare(generated, orig):
    # print(f"[{generated} \t= {orig}]")
    if len(generated) > (len(orig) + 1):
        return False
    generated = generated.ljust(len(orig), ".")
    for i in range(len(orig)):
        if orig[i] == "." and generated[i] == "#":
            return False
        elif orig[i] == "#" and generated[i] == ".":
            return False
    print(generated)
    return True


def opts2(s, groups):
    print(f"-----------------\n{s} {groups}")
    broken_springs = sum(groups) + len(groups) - 2  # each broken spring is separated by 1 working
    working_springs = len(s) - broken_springs

    z = []
    for i in range(working_springs + 1):
        z.append(f"{i}")
    while len(z[0]) < len(groups):
        q = []
        for i in range(working_springs + 1):
            for j in z:
                q.append(f"{i}{j}")
        z = q

    # print(z)
    t = ""
    sum_a = 0
    for j in z:
        q = [int(x) for x in j]
        t = ""
        for i in range(len(groups)):
            t += "." * q[i]
            t += "#" * groups[i]
            t += "."
        if compare(t, s):
            sum_a += 1
    return sum_a


def fit(st, groups):
    #print("")
    ans = 0
    if len(groups) > 0 and len(st)>0:
        itm = groups.pop(0)
        #print(f"space has room: {st[0]} = {len(st[0])}, itm = {itm}, todo={groups}")
        for i in range(len(st[0])-itm+1):
            print(f"place \"{itm}\" in {st[0]}, start at {i}")
            if itm+i<=len(st[0]): # this block fits
                print("fitted,",end='')
                if itm+i+1 < len(st[0]) and st[0][-1]!="#": #more might fit
                    print("room left")
                    p = st.copy()
                    p[0]=p[0][i+itm+1:]
                    print(f"new list={p}")
                    ans += fit(p, groups.copy())
                else:
                    print("room full")
                    if len(groups)==0:
                        print("done")
                        return 1
                    else:
                        ans += fit(st[1:].copy(), groups.copy())
            else:
                print("does not fit")
                return ans
        return ans
    else:
        return ans


def opts(st: str, groups: list):
    #print(f"-----------------\n{st} {groups}")
    spaces = list(filter(None, st.split(".")))
    #print(spaces)
    b = fit(spaces, groups)
    print(b)
    return b


sum_a = 0
for i in sample.splitlines()[-1:]:
    condition, groupstring = i.split()
    groups = [int(x) for x in groupstring.split(",")]
    sum_a += opts(condition, groups)
print(sum_a)
