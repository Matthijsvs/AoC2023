from dataclasses import dataclass

sample = """"...........
.....###.#.
.###.##..#.
..#.#...#..
....#.#....
.##..S####.
.##..#...#.
.......##..
.##.#.####.
.##..##.##.
..........."""
inp="""...................................................................................................................................
.....###.........#..#.........#.............#........##....#................##.......#..#.#.....#......#..#..#..##........#........
.#.............#............#...#.#...#.............#....#.................#.......#................#.....#....#.................#.
..#.......#..........#..........#......#.........#........................#.#...##.........#.......#.....#.##..#.............#.....
....#...#..##......#................##......#..#..#........................##.......#.............#..............##................
........#....#........#..#......#....#......#........#.........................#.....#.#.........#.................#..#..##....#...
.......................#...#.....#.....#..........#..#.........#............##.#...........#.....#..#.##..........#......#.#.....#.
..........#..........#....#.##.#...................#..#...........#...............#...........................#.....#.......##.....
.#.##..........#....#.#...#.....#.............#...............#.....................#.......#.#......#..................#..#.......
......#.#.#...................#..#.............................#...............#....#..............................###...........#.
....#...#...................#..................#...........####....#...............#....#..#.................#................#....
.............#..#.#..##.....#...#.......##.#...............#.........##..........#......................##....##....#.......#...#..
....#....#......###.#......#..#....#..#.........#....................................................#............#.........#.#....
.......#.#........##........#..#............#.##.............#..#...#....................#.#.....##.................#..............
....#....#....##...#..#......#.#.......................##......#.......................#..#.#..........#.#...........#..........#..
.#.......#..#......#......#..#............................##..........................#.............#.......#...##.#...............
...#..#...................#....#....#.....##...........#...............#...#...........#.#.#..#.#.#.#.#..#..#...#.#....#...........
.....................#..#.#..#..#..........#........#.................#.......#.......#.#......#.#..#........#............##.......
.......................................#...#.................###...##.#.....##.........##.........#..............#........#........
........#.##.........#........#.....##.............#...#...............#...................#..#.................#.........#.....#..
..#..#.#........#.....#.................................#............#.#....#.#...............##...#.....#............#..#.........
....#......#.....#....................#.........#.................#......................................................#.#....#..
....##...#...##..........#..............................#..#...#....#.......................#.#.#.....#.......#..#............##...
.#.....#.........#........#...#.....###...........#...............#.#...........#.#..........##..#..#................#..........#..
...#..#.#.#.......................................................#.##...#..........##............#..#.....#.........###...#....#..
......###.......#.#....##......#..#....................#........#.............#.#..........................#....#......###..#....#.
........#..........#......#....#.............#..#.................#..............................#.......#.#................#......
.#........#...........#.........#.....................#.........#........##.#.###......................####..#.#....#............#.
..##........#............#.#.......................#.....#.##.................#..#....#............................................
.............#..##....#.#.#...............#..................#.......##.#.....#...................##...##...#.##.............###...
......#..#....##.............................#.............................#..#....#....##.........#...#................#...#.##.#.
..#...........#........................#...........#....#...............#...............#...................#......................
....#...#.#.#...........#.#................###...............#.....##........#........................#.....##...#.#..........#....
.#..#.............#...#....##........#...#.............#............................#..#..#...........#...............##...........
...#......#..........................#.#.....##........#...#.......#...#...........##......#..............#..#.#...#.....#.#....#..
.#.#..............#................##.....#........#.....##...#....................#......#..#..............................#......
.#....................#.............#....#.............##.......#...........#.#......#...................##...#..............#.....
.....#.#...#.........##................#......#.....#...#....##.....................................................##.............
.............#........#............#.#.....#.........##.................##.....###.........#...............#....#..........#.....#.
..#.#...#....#...#......................##............#...#.#..#.........##.................................#......#........#....#.
..#.....#..................................#.#.....................#..#....#.....###..#.#...#..#.....#.......#..#..................
....#....##.#.....#.......................#.#...#......#.......................#.....#.........#....#...............#.......#......
....#.###.#......#...................#.............#...............##.........##........#......#....#..........#........##....###..
.....###....#...#.......................##.#....#.#...#.#..........#...#.....#......#.........#........#............#.....#...#....
...#.#.....#..#..............................##....#......#....#............#..#.#............#...#................................
...............#........##.#####.#......#.........................#....................#.#.#...##.#.##.#.#..................##.....
..#............................#.............#.#....#..........##.......#.#......#.#.#........#..#.#.##..................#.........
..##..##.#.............#..#.....#..#....#.#.#......#........#.................##.............#......#....#.#...........#......#..#.
..........##.#.........#.....##...................#.#...#...........................#........#...........................####......
.#......#.#.#.......#...............#.##..........#........#.................#..#.#.......#.............#....#.....................
.#.....#..#........#..#.....#...........#.#.....#.#.#...#..#..#.....#..........#.#......#............###.#.#...............#.....#.
..................##...#.......#...............#...........#.......#...............#........................................#......
.##.................#..#........#......##.............#..#.#..#....................#....................##.#.............###.......
.#......#...........#..........#...................#.........#.......##...........##..#......#.#....#.....#........................
.........................#.#.....#..#....#...#......#......................#............#................#.........................
....#....................#...#..#..............#..#...#..#..#...............#.....................#...........#..##...........#....
....#.........#...........#.....................#.#....#...#.................##.......#.#.........#...#............##..............
......................#........#...#...................#...#.###....#....#....#...............#....#...#....#......................
..................##......................##.....#...........#..........##..##.#......##............#.##...........................
.#.....................#.......#.................#..#........#...........#.#....#......#........#...........#......................
...........#.........#....#..#.#.#....#..#.......##.........#.............................#....#..#......#.#...#........#..........
.........#.........#.#....#.#.......................#..#......................#.................#....................#.#.#.........
......................#...#...#.........##.....#..............##......#...###......#...#....#.....##...........##........##........
............##..#.#......#...#.............#..#..#.........#...........#...#..#.........#...#......................................
...........#...........#..#......##..........#........#....#....#........#..................#...#.......##..#..#..#......#.........
.................................................................S.................................................................
..............#...#......#..#.....#................##......#............#........#........#..............#......#...........#......
...........#..#......#..#....#.....#..................#.....#...............#....#.....#..........#............#.#......#..#.......
..............#........#.#....#...#............#....#......#..........................................#.............#....#.........
..................#...#...............#.#...#..........#......................#.#.#.#.......#.....#..#........###..................
...................#.........##.#.#.....#..........#...........#.........#.#..#..##......#........#................................
.#.................#.....#.....#.##........#..........#...........#....#.....#...#.....#.........#..#........#.......#.#...........
..................#........#......##.#....##...#.#....#..#.....#....#...................#.....#...##...#.#......................#..
...##..............#..................#......................#.........##...#....#..#....#...........#.#..#........#...........#...
..#..#.............#................#............#............#.......#..#...##.....#.......#.......#.....#..................#.#...
..#.............#...................................#.............#......................................#..........#..............
.....#................#......#..#............#......#..#.##.#......#.......#.....#..#.........................##...........#...#.#.
...#.#............#......##........#.............#.....#..............#......###......#................#..................#......#.
....#...#.........#..#.##...###.#..............#........#..............#.#.........##....#.#.#......#....#.................#...#...
.##...#..#..........##............#........###.....#............#..#.........#............#.#.#........#..#..###............#......
.......#.................#.......#...#.......#..#......#..............#......#..##.................##....#.......................#.
...........................#.....#........#..#..............#.....##..........#....#..............#..#......##.............#.......
......#.................#................#...#.......................#.#.......##..#.........#....#.....##.............#.#.....#...
........................#.#.#.....##.......##.#........##.....#.....#...#....................#..........#..........................
.#...#........#............#.....#...#.....................#...........#.............#.##.#.....#......#.#...................#...#.
.....#..........#...........#...........................#.#.........#.............#..#.#..#...#.#....#..##..........#...........#..
.....#....#..#..................#....#...#......................#.......#..................#.......................#....#....#..#..
...#..............#...........#.#...........#.........#....#.........#.##.#..#......##.........#...##............##..#.#..#.....#..
..#............................#...#.....#......#.........#...#.....................#.....#.....#..#..#.............#..#...........
......#....#.....#.....................#.#.......#.#.#.....##.......#...#.............#..#.......#.............#..........#.#......
...............##..#................#.........#...##......#..#......#.#..#..........###..#..#..##............#..........#...#....#.
.#....#...........#..#.........#.#.#....#....#.........#.#............#....#...............##..................#.....#......#......
........#...#.....#.#................#...#....#..#....#.#..#.........#...#.................#..#.........................#..........
.........##...........................................#.................#...#.....#..#...##......#.........##............#...#.....
..#..#..#...#.#..................#....#.................#.#...#.........#.......#......##..#....#.........#......#....#............
...#...#......#....##...................##....#......#......#......#.......#.................#..#.............#.#..................
.#...#...#..##......#.#................#.#.................##..##.#..#...#.........#.........#..........................#..##......
.....................#..#..............#.......#..#...##.....................##...#....#.......................#..........#........
.......#.........#.#.....##..........#..#......#......#..#......#...#..................#....#......................................
.....#...#.....#........##......................##..................#..#...#.........###.#..#............................#.#....#..
........#....#...........#..#..........#.#.........................................#..#....#.......#...#...#...............###.....
....##..............#..#.................#..........#...........#.....#.....#....#....#.##....................#......#..#..........
..#..#..##..........##....#.#....................#.....#.#.....#............#.#........#............#....................#......#..
..........#..##......##........#....................#..#.#.............#......#........#.........#.....#....##..............##..#..
.#.......#...........#.......#.............#......###.....##.#....#....#..#....#...............................#.#..#...#.#....#...
............#....##...........#.............#.......................#......#.#...#...............##...#.....#...................#..
..#........#.........#....#..........................#....................###................#....................#.#..............
.....#..#.#........#............#.#..##.......#.....#..#...........#.........................#.......#.....#.......#........#...#..
.....##........................#..#.............#..............##.....#.....#.....#........#................#....#..##.#.........#.
..#...#........#.#...........#...#..............#.#.....#.....#.......................................#..#.#..................#....
...........#.#.....#..........#.#.......#.................#.......#.#...........#.............##........#.............#...#..#.#...
....#.....#....##.#........##..#..#.#........................#.........#.......#.........#.....###.....#.#.........................
.......#.....#.........#....#..#....#.....#..........#.#.#.........#.....#....#.........#.................#..........#...#.........
.#......#.........#..#...#......#.............................#...........#...............#.......#...#..........#...#......###....
.....................#..............#.#......#...........#......#....#.#...##.............#...##.#..#.###.#..............#.........
.#...#.............#.....#.....##..#........#............#..##....###....#.................#..#.#...##.#...#..........#...#.#......
.........#..#.....#..........................#.#..........##..#...##......................#...................#.....#............#.
.....#...##............#.........##...###......#...................#..................................#...........##..#............
.......#......................#....#...#..................#........#.#...#...........#.................#........#..........#.#.....
............#..............#.#.#..........#...#............#.......#............#.#.....#..##....#...#.#.....##........#...........
...........##.#..#...........#...#.....#.....#.............#......................#...........#...#.#.....#.......#..#..#..........
...#.#......#..#..#...............................#.............#.#..................#....#.#....#..............#................#.
.....#..................#...##.....#.#..#.#.#...................#..........................#.................#....#.....#..........
.............#..#..#....#.#..#..##...............#...............................#....#........#..#..#.......##.#........#.........
....#....#................##..#.........#.#..#....................#..............#...#......#...#..#...............................
......#....##.........##..............#....#....#.#..#..#....................................#...........#.#.#.#.###......#........
.#.#.....#.#..#.....#.....#.......##...#.......................................##......................#..........#.#....#..##..#..
............#..#.#........#..........#....#..#.....#.....#................#....##...........#...##....##.##....##.....##.#.........
...#....#...##..#.#.........#............#.........#.......................##..#.............................##....#..#.........#..
.......#.#............#...#...##....##.#..##..............#............#..............#....#.....#...#....##....#....#........#....
..................................................................................................................................."""
N = (0, -1)
NE = (1, -1)
E = (1, 0)
SE = (1, 1)
S = (0, 1)
SW = (-1, 1)
W = (-1, 0)
NW = (-1, -1)
STAY = (0, 0)
moves = [N, E, S, W]


@dataclass
class Point:
    x: int
    y: int
    steps: int = 0
    def __hash__(self):
        return self.x*1000+self.y

def get_next(p: Point):
    res = []
    for move in range(len(moves)):
        x = p.x + moves[move][0]
        y = p.y + moves[move][1]
        if 0 <= x < len(grid[0]) and 0 <= y < len(grid):
            if grid[y][x] == ".":
                res.append(Point(x, y, p.steps + 1))
    return res

def get_next(p: Point):
    res = []
    for move in range(len(moves)):
        x = p.x + moves[move][0]
        y = p.y + moves[move][1]
        #if 0 <= x < len(grid[0]) and 0 <= y < len(grid):
        if grid[y%h][x%w] == ".":
            res.append(Point(x, y, p.steps + 1))
    return res

grid = []
for y in inp.splitlines():
    grid.append(list(y))


w = len(grid[0]) - 1  # highest width
h = len(grid) - 1

start = Point(w // 2, h // 2)
steps = 26501365
plist = [start]
done = []
for i in range(steps):
    n = []
    for j in plist:
        if j not in done:
            n.extend(get_next(j))

    plist = list(set(n))
for j in plist:
    grid[j.y][j.x] = "O"
print(len(set(plist))+1)
